# モデルコンテキストプロトコル（MCP）の脆弱性：攻撃者がシステムを侵害する可能性

## 1. はじめに

本レポートは、2025年4月17日に「gbhackers」で公開された記事「Model Context Protocol Flaw Allows Attackers to Compromise Victim Systems」を基に、モデルコンテキストプロトコル（MCP）における脆弱性とその影響について分析します。MCPは、生成AI（GenAI）ツールと外部システムを統合するためのオープンスタンダードであり、その脆弱性がデータ窃盗、ランサムウェア攻撃、不正アクセスといったリスクを引き起こす可能性があることが示されています。

## 2. MCPとは

MCPは、2024年後半にAnthropic社によって導入された、GenAIツールのための「USB-Cポート」のような役割を果たすプロトコルです。具体的には、Claude 3.7 SonnetやCursor AIといったツールが、データベース、API、ローカルシステムと連携することを可能にします。これにより、業務の自動化が促進されますが、その一方で、MCPの権限管理フレームワークに十分なセキュリティ対策が施されていないため、攻撃者がこの統合を悪用する余地が生まれています。

## 3. 脆弱性の詳細

### 3.1. 攻撃シナリオ

記事では、MCPの脆弱性を利用した2つの攻撃シナリオが示されています。

1. **悪意のあるパッケージによるローカルシステムの侵害:**
 攻撃者は、ファイル管理ツールを装った悪意のあるMCPパッケージを作成します。ユーザーがこれをCursor AIと統合すると、不正なコマンドが実行され、例えば電卓アプリが起動するといった現象が発生します。現実の攻撃では、マルウェアのインストールやデータの窃取に繋がる可能性があります。

2. **ドキュメントプロンプトインジェクションによるサーバーのハイジャック:**
 操作されたドキュメントをClaude 3.7 Sonnetにアップロードし、隠されたプロンプトを実行します。これにより、ファイルアクセス権限を持つMCPサーバーが、ランサムウェアのように被害者のファイルを暗号化する可能性があります。同様に、機密データの窃取やシステムの破壊も可能です。

### 3.2. 脆弱性の原因

記事では、MCPの脆弱性の原因として以下の2点が挙げられています。

* **過剰な権限:** MCPサーバーが、無制限のファイルアクセス権限など、過剰な権限で動作することが多い。
* **ガードレールの欠如:** MCPパッケージの検証や、ドキュメント内の悪意のあるプロンプトを検出する仕組みが不足している。

これらの要因が組み合わさることで、一見無害なファイルやツールが攻撃者の手によって悪用され、従来のセキュリティ対策を回避される可能性があります。

## 4. 影響とリスク

MCPの脆弱性は、サプライチェーンリスクを増大させ、第三者の開発者を通じて企業ネットワークに侵入する可能性があります。特に、医療や金融など、機密データを扱う業界は、GDPRやHIPAAなどのコンプライアンス違反のリスクに直面する可能性があります。

## 5. 対策

記事では、リスクを軽減するための対策として以下の4点が提案されています。

* **MCP権限の制限:** ファイルやシステムへのアクセスを最小限に抑えるために、最小権限の原則を適用する。
* **アップロードされたファイルの検査:** 悪意のあるプロンプトを検出するために、AIに特化したツールを導入する。
* **第三者パッケージの監査:** MCP統合を導入する前に、脆弱性の有無を検証する。
* **異常の監視:** MCPに接続されたシステムにおける異常な活動（予期しないファイルの暗号化など）を追跡する。

## 6. Anthropic社の対応

Anthropic社は、これらの脆弱性を認識しており、2025年第3四半期に、詳細な権限管理と開発者向けのセキュリティガイドラインを導入する予定です。

## 7. まとめ

GenAIの変革的な可能性は、同時に進化するリスクを伴います。企業は、未検証のソフトウェアと同様に、MCP統合に対しても慎重な姿勢を保つ必要があります。

| 対策 | 説明 

**元記事:** [Model Context Protocol Flaw Allows Attackers to Compromise Victim Systems](https://gbhackers.com/model-context-protocol-flaw/)